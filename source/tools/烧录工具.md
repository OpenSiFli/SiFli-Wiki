# Firmware Burning Tool Impeller
[Impeller]: https://downloads.sifli.com/tools/Impeller_COMMON.7z

## Introduction
The Impeller tool is a programming and calibration tool used by Siches Technology for production lines, and can also be used as a daily programming tool. This tool runs on the Windows system, does not require installation, and can be used directly by opening Impeller.exe. The tool provides the following functions:
* Firmware IMG burning
* Generation and burning of MAC/SN information
* 48M crystal calibration, battery measurement calibration
* FLASH erasure
* Supports parallel processing of 16 channels
* Supports UART and JLINK SWD (UART is recommended)

For detailed usage instructions, refer to the "Impeller User Guide.pdf" in the doc folder of the Impeller tool package. This document only describes the burning operation steps.

## Tool Download
Click to download [Impeller Tool Package][Impeller]

## Burning Environment
Hardware environment: PC + hardware development board + Type-C USB cable; \
Software environment: Windows system + Impeller tool + firmware package;

## SF32LB5x-LCD Development Board Burning Steps
As shown in the figure below, this is the front view of the SF32LB5x-LCD development board:
```{figure} assets/烧录流程_1.png

:scale: 58%
```
\
1) Connect the pins corresponding to ①② on the development board to pull up the bootmode, so that the development board will enter boot mode when it starts; \
2) The pins ③④ on the development board must be connected with a jumper cap to ensure that the download serial port is connected normally; \
3) Use a Type-C USB cable to connect the USB port corresponding to ⑤ on the development board to the PC; \
4) Turn on the switch corresponding to ⑥, set it to the "ON" position, at this point the power indicator ⑦ will light up, and a serial port number will be enumerated in the PC device manager; \
5) Open the Impeller tool and follow the steps shown in the figure below to burn:
```{figure} assets/烧录流程_3.png

:scale: 70%
```
\
The parameter setting page for step 1) in the above figure is set as follows:
```{figure} assets/烧录流程_4.png

:scale: 70%
```
\
6) Note: After a successful download, disconnect the pins corresponding to ①② on the development board, and power it on again to start normally;

## SF32LB52-DevKit-LCD Development Board Burning Steps
As shown in the figure below, this is the front view of the SF32LB52-DevKit-LCD development board:
```{figure} assets/烧录流程_2.png

:scale: 80%
```
\
1) Use a Type-C USB cable to connect the USB port corresponding to ① on the development board to the PC. At this point, the power indicator ② will light up, and a serial port number will be enumerated in the PC device manager; \
2) Open the Impeller tool and follow the steps shown in the figure below to burn:
```{figure} assets/烧录流程_5.png

:scale: 70%
```
\
The reset of the development board in step 5) of the above figure is achieved by pressing the reset button ③ on the development board \
The parameter setting page for step 1) in the above figure is set as follows:
```{figure} assets/烧录流程_6.png

:scale: 70%
```
\

Note: The 52x platform does not have a bootmode pin, and entering boot mode is handled by the tool through a serial port command. Therefore, the tool will occupy the programming serial port when it is in monitoring mode. In the above process, a single monitoring mode is used, which means that the tool will start burning after monitoring the development board's startup and will release the serial port after completion. If the development board's startup is not monitored, the serial port will remain occupied, and you need to manually click the "Stop" button on the tool to exit monitoring mode.

## Common Issues and Suggestions
Q1: The board is connected to the PC, but no serial port is enumerated
* Confirm whether the Type-C USB cable has data transfer functionality or is damaged
* Confirm whether the Type-C USB cable is connected to the correct port on the development board, refer to the burning steps described
* Older Windows systems may require driver installation. The USB-to-serial chip on the development board is from WCH's CH34X series

Q2: A serial port is enumerated on the PC, but it does not show up in the Impeller tool
* Confirm the parameter setting page of the Impeller tool, ensure that the "Interface" type is UART and that "Port Designation" is not checked
* Click the "Scan" button on the tool to rescan the ports

Q3: The file list is empty after pasting the firmware path in the Impeller parameter setting interface
* Confirm whether the pasted path is correct and whether there is a downfile.ini or ImgBurnList.ini file in the path. If not, or if the file content is empty, contact the firmware package provider for confirmation

Q4: The burning process fails quickly (within 8 seconds)
* Confirm whether the serial port is occupied by other software, as other software cannot occupy the serial port during burning
* Confirm whether the serial port corresponding to the selected channel is the port enumerated by the development board

Q5: The burning process fails regularly, such as failing at 20% every time
* Enter the Impeller parameter setting interface and check whether the download address in the download file list exceeds the address range of the development board, i.e., confirm whether the firmware package matches the development board
* The log folder under the Impeller tool directory (log/channel/date folder) contains the burning log. You can check the last print information or consult the FAE for resolution. Common issues include abnormal soldering of external FLASH, power supply control issues, and unsupported drivers

Q6: The burning process is unstable, sometimes normal, sometimes failing
* Ensure that the burning operation is performed strictly according to the burning steps described above
* Check whether the Type-C USB cable is damaged or whether the USB port on the development board is loose
* In the Impeller parameter setting interface, reduce the serial port baud rate to 1000000 to see if it can return to normal